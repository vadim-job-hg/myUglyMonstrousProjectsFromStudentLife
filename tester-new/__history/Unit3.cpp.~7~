//---------------------------------------------------------------------------

#include <vcl.h>
#pragma hdrstop

#include "Unit3.h"
//---------------------------------------------------------------------------
#pragma package(smart_init)
#pragma link "SpeechLib_OCX"
#pragma resource "*.dfm"
TForm3 *Form3;
//---------------------------------------------------------------------------
__fastcall TForm3::TForm3(TComponent* Owner)
	: TForm(Owner)
{
}
//---------------------------------------------------------------------------
void __fastcall TForm3::FormCreate(TObject *Sender)
{
	ISpeechObjectTokens * SOTokens; //список голосовых движков
   HRESULT hr=NULL;
   //заполняем список
   hr=SpVoice1->GetDefaultInterface()->GetVoices(NULL,NULL, &SOTokens);
   if(hr==S_OK) //если список получен
   {  //заносим информацию о движках в ComboBox
      for(int i=0;i < SOTokens->Count;i++)
      {
         cbVoices->Items->AddObject(SOTokens->Item(i)->GetDescription(0),
		 	(TObject*)SOTokens->Item(i));
         SOTokens->Item(i)->AddRef();
      }
      if(cbVoices->Items->Count>0)
      {  //если движки есть - устанавливаем на первый в списке
         cbVoices->ItemIndex=0;
         cbVoicesChange(Sender);
	  }
   }
}
//---------------------------------------------------------------------------
